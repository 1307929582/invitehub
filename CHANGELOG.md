# 更新日志

所有重要更改都会记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [2.1.0] - 2025-12-03

### 新增

- 🛡️ 白名单邮箱后缀配置
  - 设置 → 白名单配置，添加管理员域名邮箱后缀
  - 以白名单后缀结尾的邮箱不会被标记为未授权成员
- 🚨 未授权成员管理专区
  - 新增独立页面管理所有 Team 的未授权成员
  - 按 Team 分组显示，支持一键清理
  - 删除前确认对话框，防止误删
  - 删除后发送 Telegram 通知

### 优化

- 📊 未授权成员检测逻辑优化
  - 支持白名单邮箱后缀排除
  - 管理员角色自动排除

---

## [2.0.2] - 2025-12-03

### 修复

- 🐛 修复数据库迁移文件链断裂问题
- 🐛 修复未授权成员检测误报 - 排除所有管理员角色（owner/admin/workspace_owner等）
- 🐛 修复兑换页面逻辑 - 支持手动输入兑换码和URL自动填入
- 🐛 修复安装脚本目录名和仓库地址

### 优化

- 🔧 更新端口配置：前端 15000，后端 18000

---

## [2.0.0] - 2025-12-03

### 重大更新

- 🚀 **商业版重构** - 移除 LinuxDO 依赖，转为独立商业版本
  - 移除 LinuxDO OAuth 登录
  - 移除 LinuxDO 用户管理
  - 统一兑换码系统

### 新增

- 📧 邮箱绑定系统
  - 兑换码首次使用时绑定邮箱
  - 同一兑换码只能绑定一个邮箱
  - 支持邮箱查询订阅状态
- ⏰ 有效期管理
  - 兑换码支持自定义有效天数（默认30天）
  - 从首次激活开始计算有效期
  - 过期后自动拒绝兑换
- 🔄 换车功能
  - 当 Team 不可用时支持换车
  - 自动分配新的可用 Team
  - 记录换车历史
- 💰 销售统计
  - Dashboard 显示今日/本周/本月销售额
  - 近7天销售趋势图表
  - 支持配置兑换码单价
- 🎨 全新用户界面
  - 苹果风格首页设计
  - 兑换页面支持手动输入和链接自动填入
  - 响应式设计，移动端适配

### 优化

- 📊 兑换码管理页面合并优化
- 🔒 28个属性测试确保系统正确性

---

## [1.4.0] - 2025-12-02

### 新增

- 🤖 Telegram Bot 全面优化
  - 美化消息显示，支持 HTML 格式和圆形进度条
  - 交互式创建 Team（按钮选择模式）
  - 管理员可在任何群组/私聊使用 Bot
  - 分离通知群和管理群权限
- ⚡ 兑换系统性能优化
  - 改为排队批量处理模式，提升并发性能
  - 异步队列处理，避免数据库锁和 API 阻塞
  - 支持兑换状态实时查询
- 🔄 队列处理系统
  - 批量邀请任务队列
  - 应用启动时自动启动队列 worker
  - 支持状态查询和进度追踪

### 修复

- 🐛 修复管理员权限逻辑，管理员可在任何地方使用 Bot
- 🐛 修复 LinuxDO 用户多次邀请限制问题
- 🐛 修复枚举值错误和命令解析问题
- 🐛 修复重复邀请检测逻辑

### 优化

- 📈 提升高并发场景下的系统稳定性
- 🔒 增强防重复邀请机制

---

## [1.3.1] - 2025-12-01

### 修复

- 🐛 修复 Telegram Bot 命令处理问题
- 🐛 修复权限验证逻辑

---

## [1.3.0] - 2025-11-30

### 新增

- 🤖 Telegram Bot 集成
  - 支持群组通知
  - 支持管理命令
  - 支持兑换码兑换

---

## [1.2.0] - 2025-11-29

### 新增

- 📊 Dashboard 数据统计优化
- 🔔 预警系统增强

---

## [1.1.0] - 2025-11-28

### 新增

- 🔐 安全性增强
- 📝 日志系统优化

---

## [1.0.0] - 2025-11-28

### 新增

- 🎉 首次发布
- 👥 多 Team 管理 - 集中管理多个 ChatGPT Team
- 🎟️ 兑换码系统 - 支持 LinuxDO 登录兑换和直接链接兑换
- 📧 批量邀请 - 一键邀请多个用户加入 Team
- 🔄 成员同步 - 自动同步 Team 成员列表
- 📈 数据统计 - Dashboard 展示关键指标
- 📝 操作日志 - 完整的审计日志
- 🔐 LinuxDO OAuth - 集成 LinuxDO 登录认证
- 📊 Team 分组 - 支持按分组管理 Team
- ⚠️ 预警系统 - Token 过期和成员超限预警
- 📧 邮件通知 - 支持 SMTP 邮件预警

### 技术栈

- 后端: FastAPI + SQLAlchemy + JWT
- 前端: React 18 + TypeScript + Ant Design
- 数据库: SQLite / PostgreSQL
- 部署: Docker Compose

---

## 版本说明

- **主版本号**: 不兼容的 API 修改
- **次版本号**: 向下兼容的功能性新增
- **修订号**: 向下兼容的问题修正
